import"./_virtual_wxt-html-plugins-DPbbfBKe.js";import{b as c}from"./browser-C4Hj5S8A.js";const i="https://conflictology-conflict.firebaseapp.com",t=document.createElement("iframe");t.src=i;document.body.appendChild(t);console.log("Conflictology Extension Offscreen Page loaded");c.runtime.onMessage.addListener((n,l,r)=>{if(console.log("Received message in offscreen:",n),n.action==="getAuth"&&n.target==="offscreen"){let a=function(e){console.log("Received iframe message:",e.data);try{if(typeof e.data=="string"&&e.data.startsWith("!_{")){console.log("Ignoring Firebase internal message");return}const o=typeof e.data=="string"?JSON.parse(e.data):e.data;console.log("Parsed iframe data:",o),window.removeEventListener("message",a),console.log("Sending response:",o.user),r(o.user)}catch(o){const s=o;console.error("Error handling iframe message:",s,e.data),r({error:s.message})}};return console.log("Processing getAuth request"),window.addEventListener("message",a),console.log("Sending initAuth message to iframe"),t.contentWindow?(t.contentWindow.postMessage({initAuth:!0},i),setTimeout(()=>{console.log("Authentication is taking longer than expected. The iframe may not be responding.")},5e3)):(console.error("iframe.contentWindow is not available"),r({error:"iframe.contentWindow is not available"})),!0}});
